<!DOCTYPE html><html ng-app="kagd"><head><script src="https://use.typekit.net/ola6uac.js"></script><script>try{Typekit.load({ async: true });}catch(e){}</script><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><title>Grant R. Klinsing </title><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/articles/feed.xml" /><link href="/stylesheets/application.css" rel="stylesheet" /><link href="/stylesheets/syntax_highlighter/monokai.css" rel="stylesheet" /><link href="/images/favicon.ico" rel="icon" type="image/ico" /><script src="/javascripts/vendor.js"></script></head><body class="articles articles_drafts articles_drafts_09-30-deploying-a-rails-app-on-digital-ocean-with-nginx" menu-classes=""><div class="grid-frame"><div class="grid-block vertical"><div class="grid-block shrink"><header class="title-bar dark"><div class="title left"><a class="brand" href="/"><img alt="Grant Klinsing" src="/images/logo.svg" /></a></div><div class="right"><nav><ul><li class="menu"><a menu-button=""><span>Menu</span><div class="bars"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div></a></li><li class="articles"><a href="/posts.html"><i class="fa fa-book"></i><span>/ Articles</span></a></li><li class="github"><a href="http://github.com/kagd" target="_blank"><i class="fa fa-github"></i><span>/ kagd</span></a></li><li class="twitter"><a href="http://twitter.com/gklinsing" target="_blank"><i class="fa fa-twitter"></i><span>/ @gklinsing</span></a></li><li class="stack-overflow"><a href="http://careers.stackoverflow.com/gklinsing" target="_blank"><i class="fa fa-stack-overflow"></i><span>/ gklinsing</span></a></li><li class="linked-in"><a href="https://www.linkedin.com/in/grantklinsing" target="_blank"><i class="fa fa-linkedin"></i><span>/ grantklinsing</span></a></li></ul></nav></div></header></div><section class="grid-block" id="main" role="main"><h1>Create Droplet</h1>

<h1>Setup Deploy User</h1>

<p>All commands should be run as root unless specified.</p>

<p>adduser demo</p>

<p>As root, run this command to add your new user to the sudo group:
gpasswd -a deploy sudo
Now your user can run commands with super user privileges!</p>

<p>Switch to new user
su - deploy</p>

<h2>SSH as deploy user</h2>

<p>Create a new directory called .ssh and restrict its permissions with the following commands:</p>

<pre><code class="prettyprint">mkdir .ssh
chmod 700 .ssh
nano .ssh/authorized_keys
</code></pre>

<p>add your public key: <code class="prettyprint">pbcopy &lt; ~/.ssh/id_rsa.pub</code></p>

<p>Now restrict the permissions of the authorized_keys file with this command:</p>

<p><code class="prettyprint">chmod 600 .ssh/authorized_keys</code></p>

<h1>Step 3 — Installing RVM and Ruby</h1>

<p>We won&rsquo;t be installing Ruby directly. Instead, we&rsquo;ll use a Ruby Version Manager. There are lots of them to choose from (rbenv, chruby, etc.), but we&rsquo;ll use RVM for this tutorial. RVM allows you to easily install and manage multiple rubies on the same system and use the correct one according to your app. This makes life much easier when you have to upgrade your Rails app to use a newer ruby.</p>

<p>Before installing RVM, you need to import the RVM GPG Key:</p>

<p>gpg &ndash;keyserver hkp://keys.gnupg.net &ndash;recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3
Then install RVM to manage our Rubies:</p>

<p>curl -sSL https://get.rvm.io | bash -s stable</p>

<h1>install postgres</h1>

<p>sudo apt-get install postgresql postgresql-contrib liqpq-dev</p>

<p>liqpq-dev contains the pg_config file. without it you will run into issues installing the pg gem</p>

<p>setup your postgres user</p>

<p>use reference</p>

<h1>Step 1 — Installing Nginx</h1>

<p>Once the VPS is secure, we can start installing packages. Update the package index files:</p>

<p>sudo apt-get update
Then, install Nginx:</p>

<p>sudo apt-get install curl git-core nginx -y</p>

<h1>Capistrano</h1>
</section></div></div><div class="mobile-menu"><ul><li class="articles"><a href="/posts.html"><i class="fa fa-book"></i><span>/ Articles</span></a></li><li class="github"><a href="http://github.com/kagd" target="_blank"><i class="fa fa-github"></i><span>/ kagd</span></a></li><li class="twitter"><a href="http://twitter.com/gklinsing" target="_blank"><i class="fa fa-twitter"></i><span>/ @gklinsing</span></a></li><li class="stack-overflow"><a href="http://careers.stackoverflow.com/gklinsing" target="_blank"><i class="fa fa-stack-overflow"></i><span>/ gklinsing</span></a></li><li class="linked-in"><a href="https://www.linkedin.com/in/grantklinsing" target="_blank"><i class="fa fa-linkedin"></i><span>/ grantklinsing</span></a></li></ul></div><script src="/javascripts/application.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-67203020-1', 'auto');
ga('send', 'pageview');</script></body></html>